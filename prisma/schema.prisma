generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model ad_search_requests {
  id                Int                 @id @default(autoincrement())
  keywords          String[]
  date_range        String?             @default("last_30_days") @db.VarChar(50)
  status            String?             @default("pending") @db.VarChar(20)
  user_id           String?             @db.VarChar(255)
  created_at        DateTime?           @default(now()) @db.Timestamp(6)
  updated_at        DateTime?           @default(now()) @db.Timestamp(6)
  processed_at      DateTime?           @db.Timestamp(6)
  error_message     String?
  name              String?             @db.VarChar(255)
  ad_search_results ad_search_results[]

  @@index([status], map: "idx_ad_search_requests_status")
}

model ad_search_results {
  id                 Int                 @id @default(autoincrement())
  request_id         Int?
  keyword            String              @db.VarChar(255)
  advertiser         String?             @db.VarChar(500)
  headline           String?
  description        String?
  destination_url    String?
  ad_format          String?             @db.VarChar(50)
  platform           String?             @db.VarChar(50)
  first_shown        DateTime?           @db.Date
  last_shown         DateTime?           @db.Date
  region             String?             @db.VarChar(100)
  raw_data           Json?
  created_at         DateTime?           @default(now()) @db.Timestamp(6)
  ad_search_requests ad_search_requests? @relation(fields: [request_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([keyword], map: "idx_ad_search_results_keyword")
  @@index([request_id], map: "idx_ad_search_results_request_id")
}

model admin_deployments {
  id         String    @id @db.VarChar(255)
  site       String    @db.VarChar(255)
  user_email String?   @db.VarChar(255)
  status     String?   @default("Pending") @db.VarChar(50)
  url        String?   @db.VarChar(500)
  created_at DateTime? @default(now()) @db.Timestamp(6)
}

model admin_expenses {
  id           String    @id @db.VarChar(255)
  service      String    @db.VarChar(100)
  category     String?   @db.VarChar(100)
  amount       Decimal?  @default(0) @db.Decimal(10, 2)
  expense_date DateTime? @db.Date
  description  String?
  status       String?   @default("paid") @db.VarChar(50)
  created_at   DateTime? @default(now()) @db.Timestamp(6)
}

model admin_templates {
  id          String    @id @db.VarChar(255)
  name        String    @db.VarChar(255)
  vertical    String?   @db.VarChar(100)
  version     String?   @default("1.0") @db.VarChar(20)
  enabled     Boolean?  @default(true)
  description String?
  created_at  DateTime? @default(now()) @db.Timestamp(6)
}

model admin_websites {
  id         String    @id @db.VarChar(255)
  name       String    @db.VarChar(255)
  user_email String?   @db.VarChar(255)
  status     String?   @default("Draft") @db.VarChar(50)
  domain     String?   @db.VarChar(255)
  created_at DateTime? @default(now()) @db.Timestamp(6)
}

model campaign_history {
  id             Int       @id @default(autoincrement())
  user_id        String
  campaign_name  String?   @db.VarChar(255)
  structure_type String?   @db.VarChar(100)
  step           Int?      @default(1)
  url            String?
  analysis_data  Json?
  keywords_data  Json?
  ads_data       Json?
  targeting_data Json?
  created_at     DateTime? @default(now()) @db.Timestamptz(6)
  updated_at     DateTime? @default(now()) @db.Timestamptz(6)

  @@index([user_id], map: "idx_campaign_history_user_id")
}

model campaign_structures {
  id          String    @id @db.VarChar(255)
  name        String    @db.VarChar(255)
  description String?
  usage_count Int?      @default(0)
  active      Boolean?  @default(true)
  created_at  DateTime? @default(now()) @db.Timestamp(6)
}

model google_ads_tokens {
  id            String    @id @db.VarChar(50)
  refresh_token String?
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  updated_at    DateTime? @default(now()) @db.Timestamp(6)
}

model support_tickets {
  id         String    @id @db.VarChar(255)
  subject    String    @db.VarChar(500)
  user_email String?   @db.VarChar(255)
  status     String?   @default("Open") @db.VarChar(50)
  priority   String?   @default("Medium") @db.VarChar(50)
  message    String?
  created_at DateTime? @default(now()) @db.Timestamp(6)
}

model user_notifications {
  id          Int       @id @default(autoincrement())
  user_id     String
  title       String    @db.VarChar(255)
  message     String
  type        String?   @default("info") @db.VarChar(50)
  read        Boolean?  @default(false)
  action_type String?   @db.VarChar(100)
  action_data Json?
  created_at  DateTime? @default(now()) @db.Timestamptz(6)

  @@index([user_id, read], map: "idx_notifications_read")
  @@index([user_id], map: "idx_notifications_user_id")
}

model users {
  id                     String    @id @db.VarChar(255)
  email                  String    @db.VarChar(255)
  full_name              String?   @db.VarChar(255)
  subscription_plan      String?   @default("free") @db.VarChar(50)
  subscription_status    String?   @default("active") @db.VarChar(50)
  role                   String?   @default("user") @db.VarChar(50)
  ai_usage               Int?      @default(0)
  created_at             DateTime? @default(now()) @db.Timestamp(6)
  updated_at             DateTime? @default(now()) @db.Timestamp(6)
  stripe_customer_id     String?
  stripe_subscription_id String?
}
